<% extend("../app.ejs") %>
<section class="mt-3">
    <div class="container-fluid">
        <div class="row">
            <div class="col-2">
                <div class="homepage-logo mt-2">
                    <img class="menu-nav" src="../images/background/menu-nav.png" alt="img logo">
                    <span>Strongbody</span>
                </div>
                <div class="home-nav">
                    <div class="nav-item">
                        <% if(user){%>
                            <a href="/users" target="_blank">Dashboard</a>

                            <%} else {%>
                                <a href="/login">Log in</a>
                            <% }%>
                    </div>
                </div>
            </div>
            <div class="col-8 d-none d-md-block d-md-flex justify-content-between ">
                <div class="d-flex flex-column">
                    <span>Specialist</span>
                    <span>Search by specialist doctor</span>
                </div>
                <div class="d-flex flex-column">
                    <span>Health facilities</span>
                    <span>Choose hospitals, clinics</span>
                </div>
                <div class="d-flex flex-column">
                    <span>Doctors</span>
                    <span>Choose good doctors</span>
                </div>
                <div class="d-flex flex-column">
                    <span>Examination package</span>
                    <span>General health check</span>
                </div>
            </div>
            <div class="col-2 d-flex justify-content-center align-items-center">
                <span title="Have questions?"><a href="https://www.youtube.com/embed/NDcQeKD2TO8?si=c7eoeypzdUuMMAjI" target="_blank" class="text-decoration-none">Do you need support?</a></span>
            </div>
        </div>
    </div>
</section>
<section class="sec-header d-flex flex-column">
    <div class="img-header d-flex flex-column mt-3 ">
        <div class="text-center mt-5"><span style="font-size: 25px">SPECIALIZED EXPLORE BOOKING PLATFORM</span></div>
        <div class="header-search align-self-center justify-content-center mt-5">
            <i class="fa fa-search"></i>
            <label for="input-search"></label>
            <input id="input-search" placeholder="Looking for information...">
            <div id="show-info-search" class="show-info-search">

            </div>
        </div>
    </div>
    <div class="content-header d-flex  justify-content-between title-and-icon align-items-center">
        <div class="d-flex flex-column ml-5 pl-5 align-items-center">
            <i class="fa fa-check"></i>
            <span>Prestigious hospitals</span>
        </div>
        <div class="d-flex flex-column align-items-center">
            <i class="fa fa-thumbs-up"></i>
            <span>Good clinics</span>
        </div>
        <div class="d-flex flex-column align-items-center">
            <i class="fa fa-user-md"></i>
            <span>Out standing doctors</span>
        </div>
        <div class="d-flex flex-column mr-5 pr-5 align-items-center">
            <i class="fa fa-clock-o"></i>
            <span>Priority examination</span>
        </div>
    </div>
</section>
<section class="sec-fields-hospital d-flex flex-column">
    <div class="sec-fields-title mx-auto d-flex my-3">
        <h2 class="">Popular specialties</h2>
        <a class="flex-grow-1 my-auto"><span class="d-block show-all-specializations">All specialties</span></a>
    </div>
    <div class="section-slide">
        <div class="slider slider-nav text-decoration-none">
            <% specializations.forEach(function(x) { %>
                <a href="/detail/specialization/<%= x.id %>" class="a-specialization text-decoration-none"
                   style="outline: none">
                    <div class="d-flex flex-column slide-fields specialization" data-specialization="<%= x.id %>">
                        <img src="/images/specializations/<%= x.image %>" alt="image bla bla">
                        <h3 class="text-decoration-none"><%= x.name %></h3>
                    </div>
                </a>
            <% }) %>
        </div>
    </div>
</section>
<section class="sec-hospitals">
    <div class="sec-fields-title mx-auto d-flex my-3">
        <h2 class="">Top clinics</h2>
        <a class="flex-grow-1 my-auto"><span class="d-block show-all-clinics">All clinics</span></a>
    </div>
    <div class="section-slide">
        <div class="slider slider-nav text-decoration-none">
            <% clinics.forEach(function(clinic) { %>
                <a href="/detail/clinic/<%= clinic.id %>" class="text-decoration-none" style="outline: none">
                    <div class="d-flex flex-column slide-fields clinics" data-clinic="<%= clinic.id %>">
                        <img src="/images/clinics/<%= clinic.image %>"
                             alt="image bla bla">
                        <h3><%= clinic.name %></h3>
                    </div>
                </a>
            <% }) %>
        </div>
    </div>
</section>
<section class="sec-doctors">
    <div class="sec-fields-title mx-auto d-flex my-3">
        <h2 class="">Out standing doctors</h2>
        <a class="flex-grow-1 my-auto"><span class="d-block show-all-doctors">All doctors</span></a>
    </div>
    <div class="section-slide">
        <div class="slider slider-nav text-decoration-none">
            <% doctors.forEach(function(doctor) { %>
                <a href="/detail/doctor/<%= doctor.id %>" class="text-decoration-none" style="outline: none">
                    <div class="slide-doctors text-decoration-none">
                        <div class="doctor-avatar">
                            <img src="/images/users/<%= doctor.avatar %>"
                                 alt="image bla bla">
                            <h3 style="color: black"><%= doctor.name %></h3>
                            <h4 style="color: black"><%= doctor.getDataValue('specializationName') %></h4>
                            <span title="Counting the number of patients have been booked" style="color: #0056b3"> <%= doctor.getDataValue('countBooking') %> patients (booked)</span>
                        </div>
                    </div>
                </a>
            <% }) %>
        </div>
    </div>
</section>
<section class="sec-posts">
    <div class="sec-fields-title mx-auto d-flex my-3">
        <h2 class="">Handbooks</h2>
        <a class="flex-grow-1 my-auto text-decoration-none" href="/all-posts"><span class="d-block text-decoration-none">All posts</span></a>
    </div>
    <div class="section-slide">
        <div class="slider slider-nav-posts">
            <% posts.forEach(function(post) { %>
                <a href="/detail/post/<%= post.id %>" class="text-decoration-none" style="outline: none">
                    <div class="d-flex flex-row slide-post">
                        <div class="img-post">
                            <img src="https://cdn.bookingcare.vn/fr/w500/2018/06/18/113541benh-vien-bao-son.jpg"
                                 alt="image bla bla">
                        </div>
                        <div class="content-post">
                            <h3>
                                <%= post.title %>
                            </h3>
                            <p>
                                <%= post.getDataValue('content') %>
                            </p>
                        </div>
                    </div>
                </a>
            <% }) %>
        </div>
    </div>
</section>
<section class="sec-for-doctors">

<div class="d-flex flex-row mx-auto main-for-doctors">
    <div class="d-flex flex-column col-5">
        <h1 class="mt-4">For doctors</h1>
        <!-- <span class="mt-3 mb-1">Build credibility and brand online</span> -->
        <!-- <span>Increase the number of patients and manage effectively</span> -->
        <a href="/contact" class="mt-5 pd-3 contact-admin text-decoration-none">CONTACT COOPERATION</a>
    </div>
    <div class="col-7 d-flex justify-content-end" style="padding-top: 5px">
        <iframe width="500" height="290" src="https://www.youtube.com/embed/NDcQeKD2TO8?si=vMZPo4jqpqHnAzbt" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>
</div>

</section>

<!-- FAQ Chatbox -->
<div id="faq-chatbox" class="faq-chatbox">
    <div class="chatbox-header" onclick="toggleChatbox()">
        <i class="fa fa-comments"></i>
        <span>FAQ</span>
        <i class="fa fa-chevron-up" id="chatbox-toggle-icon"></i>
    </div>
    <div class="chatbox-body" id="chatbox-body">
        <div class="faq-welcome">
            <p><strong>Xin ch√†o! T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n?</strong></p>
            <p>Ch·ªçn m·ªôt c√¢u h·ªèi b√™n d∆∞·ªõi:</p>
        </div>
        <div class="faq-questions">
            <div class="faq-question" onclick="showAnswer(1)">
                <i class="fa fa-question-circle"></i>
                L√†m th·∫ø n√†o ƒë·ªÉ ƒë·∫∑t l·ªãch kh√°m?
            </div>
            <div class="faq-question" onclick="showAnswer(2)">
                <i class="fa fa-question-circle"></i>
                C√≥ th·ªÉ h·ªßy l·ªãch h·∫πn kh√¥ng?
            </div>
            <div class="faq-question" onclick="showAnswer(3)">
                <i class="fa fa-question-circle"></i>
                Ph√≠ kh√°m b·ªánh nh∆∞ th·∫ø n√†o?
            </div>
            <div class="faq-question" onclick="showAnswer(4)">
                <i class="fa fa-question-circle"></i>
                L√†m sao li√™n h·ªá v·ªõi b√°c sƒ©?
            </div>
            <div class="faq-question" onclick="showAnswer(5)">
                <i class="fa fa-question-circle"></i>
                C√≥ h·ªó tr·ª£ b·∫£o hi·ªÉm y t·∫ø kh√¥ng?
            </div>
            <div class="ask-ai-section">
                <div class="separator">
                    <span>Ho·∫∑c h·ªèi AI Assistant</span>
                </div>
                <div class="ai-input-container">
                    <input type="text" id="ai-question-input" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n..." maxlength="500">
                    <button onclick="askAI()" id="ask-ai-btn" disabled>
                        <i class="fa fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
        <div class="faq-answers" id="faq-answers" style="display: none;">
            <div class="answer-header">
                <button onclick="backToQuestions()" class="back-btn">
                    <i class="fa fa-arrow-left"></i> Quay l·∫°i
                </button>
            </div>
            <div id="answer-content"></div>
        </div>
        <div class="ai-chat" id="ai-chat" style="display: none;">
            <div class="answer-header">
                <button onclick="backToQuestions()" class="back-btn">
                    <i class="fa fa-arrow-left"></i> Quay l·∫°i
                </button>
            </div>
            <div class="ai-messages" id="ai-messages">
                <div class="user-message" id="user-question"></div>
                <div class="ai-response" id="ai-response">
                    <div class="loading-indicator" id="loading-indicator">
                        <div class="typing-dots">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <span>AI ƒëang suy nghƒ©...</span>
                    </div>
                    <div class="ai-answer" id="ai-answer" style="display: none;"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal show all specializations-->
<div class="modal fade " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"
     id="modalAllSpecializations">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">All specialties</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row all-specializations-body px-2">
                    <% specializations.forEach(function(x) { %>
                        <div class="col-12 col-spe pl-3"><a href="/detail/specialization/<%= x.id %>" class="text-decoration-none"><%= x.name %> </a></div>
                        <% }) %>
                        <div class="col-12 col-spe pl-3"><a href="/all-specializations" class="text-decoration-none">View all</a></div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btn-confirm-booking-spe"  data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal show all clinics-->
<div class="modal fade " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"
     id="modalAllClinics">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">All clinics</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row all-specializations-body px-2">
                    <% clinics.forEach(function(x) { %>
                        <div class="col-12 col-spe pl-3"><a href="/detail/clinic/<%= x.id %>" class="text-decoration-none"><%= x.name %> </a></div>
                    <% }) %>
                        <div class="col-12 col-spe pl-3"><a href="/all-clinics" class="text-decoration-none">View all</a></div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btn-confirm-booking-spe"  data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal show all doctors-->
<div class="modal fade " tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"
     id="modalAllDoctors">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">All doctors</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row all-doctors-body px-2">
                    <% doctors.forEach(function(x) { %>
                        <div class="col-12 col-spe pl-3"><a href="/detail/doctor/<%= x.id %>" class="text-decoration-none"><%= x.name %> </a></div>
                    <% }) %>
                </div>
                <div class="row all-doctors-body px-2">
                        <div class="col-12 col-spe pl-3"><a href="/all-doctors %>" class="text-decoration-none">View all</a></div>

                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="btn-confirm-booking-spe"  data-dismiss="modal">OK</button>
            </div>
        </div>
    </div>
</div>

<style>
.faq-chatbox {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 350px;
    max-height: 500px;
    background: white;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    z-index: 9999;
    overflow: hidden;
    transition: all 0.3s ease;
}

.chatbox-header {
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    padding: 15px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: bold;
}

.chatbox-header:hover {
    background: linear-gradient(135deg, #0056b3, #004085);
}

.chatbox-body {
    padding: 20px;
    max-height: 400px;
    overflow-y: auto;
    transition: all 0.3s ease;
}

.chatbox-body.collapsed {
    max-height: 0;
    padding: 0 20px;
    overflow: hidden;
}

.faq-welcome {
    margin-bottom: 15px;
    text-align: center;
}

.faq-welcome p {
    margin: 5px 0;
    color: #333;
}

.faq-questions {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.faq-question {
    padding: 12px;
    background: #f8f9fa;
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: all 0.3s ease;
    border-left: 3px solid #007bff;
}

.faq-question:hover {
    background: #e3f2fd;
    transform: translateX(5px);
}

.faq-question i {
    color: #007bff;
}

.faq-answers {
    animation: slideIn 0.3s ease;
}

.answer-header {
    margin-bottom: 15px;
}

.back-btn {
    background: #6c757d;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 5px;
    transition: background 0.3s ease;
}

.back-btn:hover {
    background: #5a6268;
}

#answer-content {
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    border-left: 4px solid #007bff;
    line-height: 1.6;
}

.ask-ai-section {
    margin-top: 20px;
    padding-top: 15px;
}

.separator {
    text-align: center;
    position: relative;
    margin-bottom: 15px;
}

.separator::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background: #e0e0e0;
}

.separator span {
    background: white;
    padding: 0 15px;
    color: #666;
    font-size: 12px;
    position: relative;
}

.ai-input-container {
    display: flex;
    gap: 8px;
    align-items: center;
}

#ai-question-input {
    flex: 1;
    padding: 10px 12px;
    border: 2px solid #e0e0e0;
    border-radius: 20px;
    outline: none;
    font-size: 14px;
    transition: border-color 0.3s ease;
}

#ai-question-input:focus {
    border-color: #007bff;
}

#ask-ai-btn {
    background: #007bff;
    color: white;
    border: none;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
}

#ask-ai-btn:hover:not(:disabled) {
    background: #0056b3;
    transform: scale(1.1);
}

#ask-ai-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
}

.ai-chat {
    animation: slideIn 0.3s ease;
}

.ai-messages {
    max-height: 300px;
    overflow-y: auto;
}

.user-message {
    background: #007bff;
    color: white;
    padding: 10px 15px;
    border-radius: 15px 15px 5px 15px;
    margin-bottom: 10px;
    max-width: 80%;
    margin-left: auto;
    word-wrap: break-word;
}

.ai-response {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 15px 15px 15px 5px;
    border-left: 4px solid #28a745;
    margin-bottom: 10px;
}

.loading-indicator {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #666;
}

.typing-dots {
    display: flex;
    gap: 3px;
}

.typing-dots span {
    width: 6px;
    height: 6px;
    background: #007bff;
    border-radius: 50%;
    animation: typing 1.4s infinite ease-in-out;
}

.typing-dots span:nth-child(1) { animation-delay: -0.32s; }
.typing-dots span:nth-child(2) { animation-delay: -0.16s; }

@keyframes typing {
    0%, 80%, 100% {
        transform: scale(0);
        opacity: 0.5;
    }
    40% {
        transform: scale(1);
        opacity: 1;
    }
}

.ai-answer {
    line-height: 1.6;
    color: #333;
}

.ai-answer h5 {
    color: #007bff;
    margin-bottom: 10px;
}

.ai-answer ul {
    padding-left: 20px;
}

.ai-answer em {
    color: #666;
    font-style: italic;
}

#chatbox-toggle-icon {
    margin-left: auto;
    transition: transform 0.3s ease;
}

.collapsed-icon {
    transform: rotate(180deg);
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@media (max-width: 768px) {
    .faq-chatbox {
        width: 300px;
        right: 10px;
        bottom: 10px;
    }
}
</style>

<script>
let chatboxCollapsed = false;
const GEMINI_API_KEY = 'AIzaSyDZ_eeLkzyXaHX3kQcTxXFfz-_QZHKYUs8';
const GEMINI_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`;

// Enable/disable AI button based on input
document.addEventListener('DOMContentLoaded', function() {
    const aiInput = document.getElementById('ai-question-input');
    const aiBtn = document.getElementById('ask-ai-btn');
    
    if (aiInput && aiBtn) {
        aiInput.addEventListener('input', function() {
            aiBtn.disabled = this.value.trim().length === 0;
        });
        
        aiInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && !aiBtn.disabled) {
                askAI();
            }
        });
    }
});

function toggleChatbox() {
    const chatboxBody = document.getElementById('chatbox-body');
    const toggleIcon = document.getElementById('chatbox-toggle-icon');
    
    chatboxCollapsed = !chatboxCollapsed;
    
    if (chatboxCollapsed) {
        chatboxBody.classList.add('collapsed');
        toggleIcon.classList.add('collapsed-icon');
    } else {
        chatboxBody.classList.remove('collapsed');
        toggleIcon.classList.remove('collapsed-icon');
    }
}

function showAnswer(questionId) {
    const questionsDiv = document.querySelector('.faq-questions');
    const answersDiv = document.getElementById('faq-answers');
    const answerContent = document.getElementById('answer-content');
    
    const answers = {
        1: `
            <h5><i class="fa fa-calendar"></i> C√°ch ƒë·∫∑t l·ªãch kh√°m</h5>
            <p><strong>B∆∞·ªõc 1:</strong> Ch·ªçn chuy√™n khoa ho·∫∑c b√°c sƒ© m√† b·∫°n mu·ªën kh√°m</p>
            <p><strong>B∆∞·ªõc 2:</strong> Ch·ªçn th·ªùi gian ph√π h·ª£p trong l·ªãch c√≥ s·∫µn</p>
            <p><strong>B∆∞·ªõc 3:</strong> ƒêi·ªÅn th√¥ng tin c√° nh√¢n v√† x√°c nh·∫≠n ƒë·∫∑t l·ªãch</p>
            <p><strong>B∆∞·ªõc 4:</strong> B·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c x√°c nh·∫≠n qua email ho·∫∑c SMS</p>
            <p><em>üí° M·∫πo: N√™n ƒë·∫∑t l·ªãch tr∆∞·ªõc √≠t nh·∫•t 1-2 ng√†y ƒë·ªÉ c√≥ nhi·ªÅu l·ª±a ch·ªçn th·ªùi gian h∆°n.</em></p>
        `,
        2: `
            <h5><i class="fa fa-times-circle"></i> H·ªßy l·ªãch h·∫πn</h5>
            <p><strong>C√≥ th·ªÉ h·ªßy:</strong> B·∫°n c√≥ th·ªÉ h·ªßy l·ªãch h·∫πn tr∆∞·ªõc 24 gi·ªù m√† kh√¥ng m·∫•t ph√≠</p>
            <p><strong>C√°ch h·ªßy:</strong></p>
            <ul>
                <li>ƒêƒÉng nh·∫≠p v√†o t√†i kho·∫£n v√† v√†o ph·∫ßn "L·ªãch h·∫πn c·ªßa t√¥i"</li>
                <li>G·ªçi ƒëi·ªán tho·∫°i ƒë·∫øn hotline: <strong>1900-xxxx</strong></li>
                <li>G·ª≠i email ƒë·∫øn: support@strongbody.com</li>
            </ul>
            <p><em>‚ö†Ô∏è L∆∞u √Ω: H·ªßy mu·ªôn h∆°n 24 gi·ªù c√≥ th·ªÉ ph√°t sinh ph√≠ h·ªßy l·ªãch.</em></p>
        `,
        3: `
            <h5><i class="fa fa-money"></i> Ph√≠ kh√°m b·ªánh</h5>
            <p><strong>Ph√≠ kh√°m:</strong> T·ª´ 200.000ƒë - 500.000ƒë t√πy v√†o chuy√™n khoa</p>
            <p><strong>Thanh to√°n:</strong></p>
            <ul>
                <li>Ti·ªÅn m·∫∑t t·∫°i ph√≤ng kh√°m</li>
                <li>Chuy·ªÉn kho·∫£n ng√¢n h√†ng</li>
                <li>V√≠ ƒëi·ªán t·ª≠ (MoMo, ZaloPay)</li>
                <li>Th·∫ª t√≠n d·ª•ng/ghi n·ª£</li>
            </ul>
            <p><strong>∆Øu ƒë√£i:</strong> Gi·∫£m 10% cho l·∫ßn kh√°m ƒë·∫ßu ti√™n</p>
            <p><em>üí≥ Ch·∫•p nh·∫≠n h·∫ßu h·∫øt c√°c lo·∫°i b·∫£o hi·ªÉm y t·∫ø.</em></p>
        `,
        4: `
            <h5><i class="fa fa-phone"></i> Li√™n h·ªá v·ªõi b√°c sƒ©</h5>
            <p><strong>Tr∆∞·ªõc kh√°m:</strong> Li√™n h·ªá qua hotline ho·∫∑c nh·∫Øn tin trong app</p>
            <p><strong>Sau kh√°m:</strong></p>
            <ul>
                <li>T∆∞ v·∫•n qua ƒëi·ªán tho·∫°i (mi·ªÖn ph√≠ trong 7 ng√†y)</li>
                <li>Nh·∫Øn tin tr·ª±c ti·∫øp v·ªõi b√°c sƒ© qua app</li>
                <li>Email: doctor@strongbody.com</li>
            </ul>
            <p><strong>Kh·∫©n c·∫•p:</strong> G·ªçi 115 ho·∫∑c ƒë·∫øn tr·ª±c ti·∫øp b·ªánh vi·ªán</p>
            <p><em>üïê Th·ªùi gian ph·∫£n h·ªìi: 2-4 gi·ªù trong gi·ªù h√†nh ch√≠nh.</em></p>
        `,
        5: `
            <h5><i class="fa fa-shield"></i> H·ªó tr·ª£ b·∫£o hi·ªÉm y t·∫ø</h5>
            <p><strong>ƒê∆∞·ª£c h·ªó tr·ª£:</strong></p>
            <ul>
                <li>BHYT Nh√† n∆∞·ªõc</li>
                <li>B·∫£o hi·ªÉm t∆∞ nh√¢n (Prudential, AIA, B·∫£o Vi·ªát...)</li>
                <li>B·∫£o hi·ªÉm c√¥ng ty</li>
            </ul>
            <p><strong>Quy tr√¨nh:</strong></p>
            <p>1. Mang theo th·∫ª BHYT khi ƒë·∫øn kh√°m</p>
            <p>2. Khai b√°o th√¥ng tin b·∫£o hi·ªÉm khi ƒëƒÉng k√Ω</p>
            <p>3. Ph√≤ng kh√°m s·∫Ω h·ªó tr·ª£ l√†m th·ªß t·ª•c</p>
            <p><em>üìã L∆∞u √Ω: M·ªôt s·ªë d·ªãch v·ª• c√≥ th·ªÉ kh√¥ng ƒë∆∞·ª£c b·∫£o hi·ªÉm chi tr·∫£.</em></p>
        `
    };
    
    answerContent.innerHTML = answers[questionId] || '<p>C√¢u tr·∫£ l·ªùi kh√¥ng t√¨m th·∫•y.</p>';
    questionsDiv.style.display = 'none';
    answersDiv.style.display = 'block';
    document.querySelector('.faq-welcome').style.display = 'none';
}

async function askAI() {
    const input = document.getElementById('ai-question-input');
    const question = input.value.trim();
    
    if (!question) return;
    
    // Show AI chat interface
    const questionsDiv = document.querySelector('.faq-questions');
    const aiChatDiv = document.getElementById('ai-chat');
    const userMessageDiv = document.getElementById('user-question');
    const loadingDiv = document.getElementById('loading-indicator');
    const aiAnswerDiv = document.getElementById('ai-answer');
    
    // Hide questions and show AI chat
    questionsDiv.style.display = 'none';
    aiChatDiv.style.display = 'block';
    document.querySelector('.faq-welcome').style.display = 'none';
    
    // Display user question
    userMessageDiv.textContent = question;
    userMessageDiv.style.display = 'block';
    
    // Show loading
    loadingDiv.style.display = 'flex';
    aiAnswerDiv.style.display = 'none';
    
    // Clear input
    input.value = '';
    document.getElementById('ask-ai-btn').disabled = true;
    
    try {
        const response = await fetch(GEMINI_API_URL, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                contents: [{
                    parts: [{
                        text: `B·∫°n l√† m·ªôt tr·ª£ l√Ω AI th√¥ng minh c·ªßa n·ªÅn t·∫£ng y t·∫ø Strongbody. Nhi·ªám v·ª• c·ªßa b·∫°n l√† tr·∫£ l·ªùi c√°c c√¢u h·ªèi v·ªÅ s·ª©c kh·ªèe, y t·∫ø, ƒë·∫∑t l·ªãch kh√°m b·ªánh v√† c√°c d·ªãch v·ª• c·ªßa ph√≤ng kh√°m m·ªôt c√°ch chuy√™n nghi·ªáp, th√¢n thi·ªán v√† h·ªØu √≠ch.

Ng·ªØ c·∫£nh v·ªÅ Strongbody:
- L√† n·ªÅn t·∫£ng ƒë·∫∑t l·ªãch kh√°m b·ªánh tr·ª±c tuy·∫øn
- C√≥ nhi·ªÅu chuy√™n khoa, b√°c sƒ© gi·ªèi v√† ph√≤ng kh√°m uy t√≠n
- H·ªó tr·ª£ ƒë·∫∑t l·ªãch online, thanh to√°n ƒëa d·∫°ng
- C√≥ b·∫£o hi·ªÉm y t·∫ø v√† ch∆∞∆°ng tr√¨nh ∆∞u ƒë√£i

H√£y tr·∫£ l·ªùi c√¢u h·ªèi sau m·ªôt c√°ch chi ti·∫øt, d·ªÖ hi·ªÉu v√† c√≥ c·∫•u tr√∫c r√µ r√†ng. S·ª≠ d·ª•ng emoji ph√π h·ª£p ƒë·ªÉ l√†m cho c√¢u tr·∫£ l·ªùi sinh ƒë·ªông h∆°n:

C√¢u h·ªèi: ${question}`
                    }]
                }]
            })
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
        
        if (data.candidates && data.candidates[0] && data.candidates[0].content) {
            const aiResponse = data.candidates[0].content.parts[0].text;
            
            // Hide loading and show answer
            loadingDiv.style.display = 'none';
            aiAnswerDiv.innerHTML = formatAIResponse(aiResponse);
            aiAnswerDiv.style.display = 'block';
        } else {
            throw new Error('Kh√¥ng nh·∫≠n ƒë∆∞·ª£c ph·∫£n h·ªìi h·ª£p l·ªá t·ª´ AI');
        }
        
    } catch (error) {
        console.error('AI API Error:', error);
        
        // Hide loading and show error
        loadingDiv.style.display = 'none';
        aiAnswerDiv.innerHTML = `
            <div style="color: #dc3545; text-align: center; padding: 20px;">
                <i class="fa fa-exclamation-triangle"></i>
                <p><strong>Xin l·ªói!</strong></p>
                <p>Hi·ªán t·∫°i AI ƒëang g·∫∑p s·ª± c·ªë. Vui l√≤ng:</p>
                <ul style="text-align: left; margin-top: 10px;">
                    <li>Th·ª≠ l·∫°i sau v√†i ph√∫t</li>
                    <li>Li√™n h·ªá hotline: <strong>1900-xxxx</strong></li>
                    <li>Email: support@strongbody.com</li>
                </ul>
                <p><em>C·∫£m ∆°n b·∫°n ƒë√£ th√¥ng c·∫£m! üôè</em></p>
            </div>
        `;
        aiAnswerDiv.style.display = 'block';
    }
}

function formatAIResponse(text) {
    // Basic formatting for AI response
    let formatted = text
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/\n\n/g, '</p><p>')
        .replace(/\n/g, '<br>');
    
    return `<p>${formatted}</p>`;
}

function backToQuestions() {
    const questionsDiv = document.querySelector('.faq-questions');
    const answersDiv = document.getElementById('faq-answers');
    const aiChatDiv = document.getElementById('ai-chat');
    
    questionsDiv.style.display = 'flex';
    answersDiv.style.display = 'none';
    aiChatDiv.style.display = 'none';
    document.querySelector('.faq-welcome').style.display = 'block';
}

// Auto-hide chatbox on mobile when scrolling
let lastScrollTop = 0;
window.addEventListener('scroll', function() {
    if (window.innerWidth <= 768) {
        let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const chatbox = document.getElementById('faq-chatbox');
        
        if (scrollTop > lastScrollTop && scrollTop > 100) {
            // Scrolling down
            chatbox.style.transform = 'translateY(100px)';
            chatbox.style.opacity = '0.7';
        } else {
            // Scrolling up
            chatbox.style.transform = 'translateY(0)';
            chatbox.style.opacity = '1';
        }
        lastScrollTop = scrollTop;
    }
});
